$(function(){function o(o,s){return console.log("Connexion de "+o+" mdp "+s),$.ajax({url:"user/connexion",type:"POST",data:"login="+o+"&mdp="+s,contentType:"application/x-www-form-urlencoded; charset=utf-8",dataType:"json",success:function(s){var n=JSON.stringify(s),t=JSON.parse(n);void 0==s.erreur?(console.log("Connexion reussi ",s),setCookie(C_NAME_KEY,s.cle),setCookie(C_NAME_LOGIN,o),setCookie(C_NAME_ID,s.id),window.location.href="accueil.html"):(console.log("Connexion Fail ",s.message),e("#ErrorLogin",t.message))},error:function(o,e,s){console.log("Bug"),console.log(o),alert("Erreur Ajax")}}),!1}function e(o,e){var s=$(o);console.log(e+" toz"),s.html("<div class='alert alert-danger' id='ErrorMessage'><a class='close' data-dismiss='alert' aria-label='close'>×</a>"+e+"</div>")}function s(o,e){var s=$(o);console.log(e+" toz"),s.html("<div class='alert alert-success' id='SuccessMessage'><a class='close' data-dismiss='alert' aria-label='close'>×</a>"+e+"</div>")}function n(o){return console.log("Forgot de "+o),$.ajax({url:"user/recupererMdp",type:"POST",data:"email="+o,contentType:"application/x-www-form-urlencoded; charset=utf-8",dataType:"json",success:function(o){console.log(JSON.stringify(o));var n=JSON.stringify(o),t=JSON.parse(n);void 0==o.erreur?(console.log("Recuperation reussi ",o),s("#AlertMdpOublie",t.success)):(console.log("Recuperation Fail ",o.message),e("#AlertMdpOublie",t.message))},error:function(o,e,s){console.log("Bug"),alert("Erreur Ajax")}}),!1}function t(){var o=$(this).find(".modal-dialog");o.css("margin-top",Math.max(0,($(window).height()-o.height())/4))}return 1==isConnected()?void(window.location.href="accueil.html"):($("#login").validate({rules:{login:{required:!0},password:{required:!0,minlength:6}},messages:{login:"<p class='text-nowrap'>Nom d'utilisateur manquant</p>",password:{required:"<p>Mot de passe manquant</p>",minlength:"<p>Votre mot de passe est trop court</p>"}},tooltip_options:{login:{placement:"right",html:!0},password:{placement:"right",html:!0}},submitHandler:function(e){o(e.login.value,e.password.value)}}),$("#forgot").validate({rules:{forgotPassword:{required:!0}},messages:{forgotPassword:"<p>Adresse email invalide</p>"},tooltip_options:{forgotPassword:{placement:"bottom",html:!0}},submitHandler:function(o){n(o.forgotPassword.value)}}),$("#send").on("click",function(){$("#forgot").submit(),console.log("validee")}),$("#forgotModal").on("shown.bs.modal",function(){document.activeElement.blur(),$("#forgotPassword").focus(),$(".tooltip").remove()}),$(".modal").on("shown.bs.modal",t),void $(window).on("resize",function(){$(".modal:visible").each(t)}))});