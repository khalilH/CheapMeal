$(function(){function e(e,t){this.id=e,this.login=t}function t(e,t,o,n){this.id=e,this.auteur=t,this.titre=o,this.photo="../images/"+n+".png"}function o(e,t){this.recettesRecentes=e,this.recettesBest=t}function n(e){return!isNaN(e-0)}function r(r,c){if(0==r.length){var i;return void 0==c.Erreur||0==c.Erreur?i=new o(c.recettesRecentes,c.recettesBest):(i=new Object,i.Erreur=c.Erreur),i}if(n(r)&&c.auteur instanceof e){var s=new t(c._id,c.auteur,c.titre,c.photo);return console.log("J'ai cree une recette"),s}if(n(r)&&void 0!=c.source&&c.source.auteur instanceof e){var s=new t(c.source._id,c.source.auteur,c.source.titre,c.source.photo);return console.log("J'ai cree une recette lol"),s}if("auteur"==r){var a;return a=new e(c.idAuteur,c.loginAuteur)}return c}function c(){console.log("Loading home page");var e="";void 0!=getCookie(C_NAME_KEY)&&(e="cle="+getCookie(C_NAME_KEY)),$.ajax({url:"recette/getAccueil",type:"GET",data:e,contentType:"application/x-www-form-urlencoded; charset=utf-8",dataType:"json",success:function(e){var t=JSON.stringify(e);if(void 0==t.erreur){var o=JSON.parse(t,r);console.log(o),i(o)}},error:function(e,t,o){console.log("Bug"),console.log(e),alert("Erreur Ajax")}})}function i(e){$("#recentRecipe").html(e.getHtmlRecent()),$("#BestRecipe").html(e.getHtmlBest())}function s(e){console.log("Toz"),$("#recettes-Container").html(e.getHtmlBest())}if(t.prototype.getHtml=function(){var e="<div  class='col-md-6 col-lg-4'><div class='recette-container recette' id='"+this.id+"' ><div class='recette-img'><img width='100%' height='100%' src='"+this.photo+"'</img></div><div class='recette-footer'><h3 class='titre-recette'>"+this.titre+"</h3></div></div></div>";return e},o.prototype.getHtmlRecent=function(){for(var e="",t=0;t<this.recettesRecentes.length;t++)e+=this.recettesRecentes[t].getHtml()+"\n \n";return e},o.prototype.getHtmlBest=function(){for(var e="",t=0;t<this.recettesBest.length;t++)console.log(this.recettesBest[t]),e+=this.recettesBest[t].getHtml()+"\n \n";return 0==this.recettesBest.length&&(e+="<div class='panel panel-danger mg-top-50'><div class='panel-heading'><span class='glyphicon glyphicon-thumbs-down'></span> Dommage</div><div class='panel-body'><h1> Votre recherche n'a abouti à aucun résultats.</h1></div></div>"),e},1===(bool=isConnected()))loadNavbarConnected(),console.log("connecte"),$("#rightNavbar").prepend("<button id='addRecette' type='button' class='btn btn-primary navbar-btn'><span class='glyphicon glyphicon-plus'></span> Ajouter Recette</button>");else{if(-1!==bool)return console.log("Invalide"),void(window.location.href="connexion.html");loadNavbarDisconnected(),console.log("deconnecte")}c(),$("#addRecette").on("click",function(){window.location.href="autocomplete.html"}),$("#searchForm").on("submit",function(e){e.preventDefault();var t=this.search.value,o="query="+t;void 0!=getCookie(C_NAME_KEY)&&(o+="&cle="+getCookie(C_NAME_KEY)),$.ajax({url:"search",type:"GET",data:o,contentType:"application/x-www-form-urlencoded; charset=utf-8",dataType:"json",success:function(e){var t=JSON.stringify(e);if(console.log(t),void 0==t.erreur){var o=JSON.parse(t,r);console.log(o),s(o)}else 40==e.erreur?(alert("Votre session a expiré"),deconnexion()):alert("Erreur: "+e.message)},error:function(e,t,o){console.log("Bug"),console.log(e),alert("Erreur Ajax")}})}),$(document.body).on("click",".recette",function(){console.log("J'ai clique sur une recette ",this.id),window.location.href="recette.html?idRecette="+this.id})});